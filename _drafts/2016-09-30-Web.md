### WWW : World Wide Web

HTTP : Hypertext Transfer Protocol
HTML : Hypertext Markup Language
URL : Uniform Resource Locator

웹 클라이언트는 HTTP로 URL을 요청하고, 서버로부터 HTML을 받는다.

파이썬으로 할 수 있는 웹 작업들

* 원격 사이트에 접근할 수 있는 클라이언트
* 웹사이트와 웹 API에서 데이터를 제공하는 서버
* 웹 페이지 이외의 데이터를 교환하기 위한 웹 API와 서비스

### 웹 클라이언트

낮은 수준의 인터넷 네트워크를 TCP/IP(Transmission Control Protocol/Internet Protocol)라고 한다. TCP/IP는 컴퓨터 사이에 바이트를 전송하지만, 그것이 무엇인지는 상관하지 않는다. 이 바이트를 해석하는 일은 더 높은 수준의 프로토콜에서 처리한다. HTTP는 웹 데이터를 교환하는 표준 프로토콜이다.

HTTP는 무상태(stateless)라는 특성이 있다. 웹 브라우저에서 생성된 각 HTTP 커넥션은 모두 독립적이다. 

이러한 문제에는 다음과 같은 고려사항이 있다. 

* 캐싱 caching : 변하지 않는 컨텐츠는 웹 클라이언트에 저장하고, 다시 서버에서 다운로드하는 것을 피하기 위해 저장된 컨텐츠를 사용한다.
* 세션 session : 쇼핑 웹사이트는 장바구니의 컨텐츠를 기억해야 한다.
* 인증 authentication : 아이디와 비밀번호를 요구하는 사이트는 사용자가 로그인할 때, 이 둘을 기억하여 사용자를 식별한다.

무상태에 대한 해결책 중 쿠기 cookie 가 있다. 서버가 클라이언트를 식별할 수 있도록 보내는 특정 정보를 쿠키라고 한다. 클라이언트가 다시 서버로 쿠키를 보내 서버가 클라이언트를 식별할 수 있게 한다.

### HTTP

HTTP는 텍스트 기반 프로토콜입니다. 

가장 일반적인 HTTP 명령은 GET입니다. 이는 웹 브라우저에서 주소창에 URL을 입력할 때 사용하는 메소드입니다. GET 메소드는 HTML 파일과 같은 지정된 리소스의 내용을 검색해서 클라이언트에 반환합니다.

HTTP의 HEAD 메소드는 리소스에 대한 몇 가지 기본 정보를 검색합니다. 

HTTP HEAD 요청을 하면 헤더만 응답받습니다. HTTP GET 또는 POST 명령을 사용할 때 홈페이지로부터 데이터도 받게 됩니다. 홈페이지에는 HTML, CSS, 자바스크립트의 혼합물 등을 포함합니다.

#### HTTP 응답 코드

HTTP의 응답 코드는 수십 개가 있는데, 백자리 첫번째 숫자에 따라 다섯 가지 범위로 나뉩니다. 

* 1xx : 조건부 응답 information - 서버는 요청을 받았지만, 클라이언트에 대한 몇 가지 추가 정보가 필요함을 말합니다. 
* 2xx : 성공 success - 성공적으로 처리되었슴을 알립니다. 200 이외의 모든 성공 코드는 추가 사항을 전달하기 위한 것입니다. 
* 3xx : 리다이렉션 redirection - 리소스가 이전되어 클라이언트에 새로운 URL을 응답해 줌을 알립니다.
* 4xx : 클라이언트 에러 client error - 자주 발생하는 404 Not Found는 클라이언트 측에 문제가 있음을 나타냅니다. 
* 5xx : 서버 에러 server error - 500은 서버 에러를 나타냅니다. 웹 서버와 백엔트 어플리케이션 서버가 연결되어 있지 않다면 502 (불량 게이트웨이 bad gateway) 에러를 볼 수 있습니다. 

#### 응답 포맷

웹 서버는 원하는 포맷으로 데이터를 전송할 수 있습니다. 보통 HTML을 전송하지만, JSON 포맷을 전송할 수도 있습니다. 데이터 포맷은 HTTP 헤더의 Content-Type 값에 있습니다. 

`application/json` 문자열은 MIME (Multipurpose Internet Mail Extensions) 타입입니다. HTML을 위한 MIME 타입은 `text/html` 입니다.

### 파이썬 표준 웹 라이브러리

파이선 3버전에서는 웹 모듈들을 크게 두 개의 패이키로 묶었습니다. `http`와 `urllib`가 그것입니다.

#### HTTP

`http`는 모든 클라이언트-서버 HTTP 세부 사항을 관리합니다. 

* `client`는 클라이언트 부분을 관리합니다.
* `server`는 파이썬 웹 서버를 작성하는데 도움을 줍니다.
* `cookies`와 `cookiejar`는 사이트 방문자의 데이터를 저장하는 쿠키를 관리합니다.

#### URLLIB

`urllib`는 `http` 위에서 실행됩니다. 

* `request`는 클라이언트의 요청을 처리합니다.
* `response`는 서버의 응답을 처리합니다. 
* `parse`는 URL을 분석합니다.

### 웹 서버 

#### 간단한 파이썬 웹 서버

아래와 같은 한 줄이면 간단히 웹 서버를 실행할 수 있습니다. 

```
$ python -m http.server
```

이상이 없으면 아래와 같은 초기 상태 메시지를 출력합니다.

```
Serving HTTP 0.0.0.0 port 8000 ...
```

0.0.0.0은 모든 TCP 주소를 의미합니다. 그래서 웹 클라이언트는 서버가 어떤 주소를 가졌든 상관없이 접근할 수 있습니다. 

웹 브라우저에서 `http://localhost:8000`를 입력하면, 브라우저에 현재 디렉토리 리스트가 나타나면서, 서버에는 아래와 같은 액세스 로그 라인이 출력됩니다. 

```
127.0.0.1 - - [02/Oct/2016 01:29:35] "GET / HTTP/1.1" 200 -
```

`localhost`와 `127.0.0.1`은 로컬 컴퓨터에 대한 TCP 동의어이며, 로컬 컴퓨터이므로 인터넷 연결과 상관없이 명령이 실행됩니다. 

각각의 단어는 의미가 있습니다. Introducing Python 책의 295 페이지 내용을 정리합니다. 

#### 웹 서버 케이트웨이 인터페이스 : CGI

동적으로 프로그램을 실행하는 웹 서버를 만들기 위해서 초창기에는 CGI(공용 게이트웨이 인터페이스, Common Gateway Inferface)를 만들어서 웹 서버가 외부 프로그램을 실행하고, 그 결과를 반환하도록 설계했었습니다. CGI는 클라이언트에서 받은 인자를 서버에서 처리하여 외부 프로그램으로 전달합니다. 프로그램은 각 클라이언트의 접근을 위해 처음부터 다시 시작합니다. 이러한 접근 방식은 확장성을 떨어뜨립니다. 작은 프로그램도 시작하는데 상당한 시간이 걸릴 수 있기 때문입니다.

이러한 지연을 막기 위해서 개발자들은 웹 서버에 인터프리터를 두기 시작했습니다. Apache는 `mod_php` 모듈내에서는 PHP, `mod_perl` 내에서는 Perl, `mod_python` 내에서는 Python을 실행합니다. 그리고 이러한 동적 언어의 코드는 외부 프로그램이 아닌 장기적으로 작동하는 apache 프로세스 내에서 실행됩니다. 

다른 방법은 별도로 장기적으로 작동하는 프로그램 내에서 동적 언어를 실행하고, 웹 서버와 통신하는 것입니다. 이러한 것에는 FastCGI, SCGI가 있습니다. 

파이썬 웹 개발은 파이썬 웹 어플리케이션과 웹 서버 사이의 범용적인 API인 WSGI(웹 서버 게이트웨이 인터페이스, Web Server Gateway Interface)의 정의에서 시작했습니다.

#### 비 파이썬 웹 서버

제품으로 배포할 때는 빠른 웹 서버로 파이썬을 실행하는 것이 좋습니다. 다음의 2가지가 많이 쓰입니다.

* 아파치(apache)와 `mod_wsgi` 모듈 : 가장 인기 많은 웹 서버입니다.
* 엔진엑스(nginx)와 uWSCI 웹 서버 : 안정성과 메모리를 적게 사용하는 것으로 유명한 웹 서버입니다.


### 웹 프레임웍

웹 프레임웍은 웹사이트를 구축할 수 있는 기능을 제공합니다. 그레서 단순한 웹(HTTP) 서버 보다 더 많은 작업을 수행합니다. Routing (서버 함수의 URL), Template (HTML을 동적으로 생성), Debugging 등에 대한 기능이 있습니다. 

#### 웹 프레임웍

웹 프레임웍은 최소한 클라이언트의 요청과 서버의 응답을 처리해야 합니다. 이는 아래의 일부 혹은 모든 기능을 제공해야 함을 의미합니다. 

* 라우트 route : URL을 해석하여 해당 서버의 파일이나 파이썬 코드를 찾아줍니다.
* 템플릿 template : 서버 사이드의 데이터를 HTML 페이지에 병합합니다.
* 인증 authentication 및 권한 authorization : 사용자 이름과 비밀번호, 퍼미션 permission을 처리합니다.
* 세션 session : 웹사이트에 방문하는 동안 사용자의 임시 데이터를 유지합니다.

#### URL 

URL이 `/`인 경우는 홈페이지를 의미할 수 있습니다. (이 부분은 좀 더 살펴봐야 합니다.) root가 `.`인 경우는 현재 디렉토리를 의미합니다.

### 파이썬 웹 프레임웍

#### Bottle

#### Flask

웹 서버를 배포할 때는 `run()`을 호출할 때, `debug=True`로 설정하지 않는 것이 좋습니다. 왜냐면 서버에 대한 너무 많은 정보가 잠재적인 침입자에게 노출될 수 있기 때문입니다. 



### 참고 자료 

[텔넷 명령어 강제 중단하고 싶을 때,,](http://stupid86.tistory.com/entry/텔넷-명령어-강제-중단하고-싶을-때)